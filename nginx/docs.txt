Générations certificats de sécurité :

sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
-keyout selfsigned.key -out selfsigned.crt

Voir les ports utilisés :

sudo netstat -tuln
sudo lsof -i -P -n


	- FR
	- Occitanie
	- Perpignan
	- 42 Perpignan
	- Student
	- localhost / nom du domaine
	- email (momillio@student.42perpignan.fr)


mkdir -p nginx/pki/{ca,issued,private,csr,ext}

openssl genrsa -out nginx/pki/private/ca.key 4096
openssl req -x509 -new -nodes -sha256 -days 3650 \
  -key nginx/pki/private/ca.key \
  -out nginx/pki/ca/ca.crt \
  -subj "/CN=Transcendence-Internal-CA"

# AUTH
openssl genrsa -out nginx/pki/private/auth-service.key 2048
openssl req -new -sha256 -key nginx/pki/private/auth-service.key \
  -out nginx/pki/csr/auth-service.csr -subj "/CN=auth-service"
openssl x509 -req -sha256 -days 825 \
  -in nginx/pki/csr/auth-service.csr \
  -CA nginx/pki/ca/ca.crt -CAkey nginx/pki/private/ca.key -CAcreateserial \
  -out nginx/pki/issued/auth-service.crt \
  -extfile nginx/pki/ext/auth-service.san.cnf

# USERS
openssl genrsa -out nginx/pki/private/users-service.key 2048
openssl req -new -sha256 -key nginx/pki/private/users-service.key \
  -out nginx/pki/csr/users-service.csr -subj "/CN=users-service"
openssl x509 -req -sha256 -days 825 \
  -in nginx/pki/csr/users-service.csr \
  -CA nginx/pki/ca/ca.crt -CAkey nginx/pki/private/ca.key -CAcreateserial \
  -out nginx/pki/issued/users-service.crt \
  -extfile nginx/pki/ext/users-service.san.cnf

openssl verify -CAfile nginx/pki/ca/ca.crt nginx/pki/issued/auth-service.crt
openssl verify -CAfile nginx/pki/ca/ca.crt nginx/pki/issued/users-service.crt

Pour tester la connexion https:
  -curl -vk https://localhost/users/health
