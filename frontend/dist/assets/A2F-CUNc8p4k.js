const o="pendingUserId";function c(t){sessionStorage.setItem(o,t)}function u(){return sessionStorage.getItem(o)}function f(){sessionStorage.removeItem(o)}async function h(t,s){const e=await fetch("/auth/2fa/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t,code:s})});if(e.ok&&e.status===204)return;let n=null;try{n=await e.json()}catch{}if(!e.ok)throw new Error((n==null?void 0:n.error)||e.statusText||"Vérification échouée")}async function d(t){const[s,e]=await Promise.all([fetch(`/users/getUser/${encodeURIComponent(t)}`),fetch(`/auth/getEmail/${encodeURIComponent(t)}`)]);if(!s.ok||!e.ok){const a=await s.text().catch(()=>""),i=await e.text().catch(()=>"");throw new Error(`User fetch error. users:${s.status} ${a} | auth:${e.status} ${i}`)}const[n,r]=await Promise.all([s.json(),e.json()]);return{...n,email:r.email,userId:r.userId}}export{f as c,d as f,u as g,c as s,h as v};
